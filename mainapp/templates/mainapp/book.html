{% extends "mainapp/base.html" %}
{% load static %}
<!--https://www.bootdey.com/snippets/view/product-full-detail-->
<link rel="stylesheet" type="text/css" href="{% static 'css/book.css' %}"/>
{% block content %}
<div class="container">
    <div class="col-sm-12 col-md-12 col-lg-12">
        <!-- product -->
        <div class="product-content product-wrap clearfix product-deatil">
            <div class="row">
                <div class="col-md-5 col-sm-12 col-xs-12 ">
                    <div class="product-image">
                        <img src="{{thumbnail}}" alt="No Image" style="min-width: 250px; min-height: 250px; padding: 13px; display: inline-block;">
                    </div>
                </div>
                <div class="col-md-7 col-sm-12 col-xs-12">
                	<h2 class="name">
                		{{title}} by <a href="http://www.google.com/search?q={{authors}}">{{authors}}</a><br>
                			<div id="star-rating">
                			</div>
						</h2>
                    <hr>
                    <h3 class="price-container">
							<button class="btn btn-white btn-default" id="add-to-favourites"><i class="fa fa-star"></i> Add to Favourites </button>
                            <button class="btn btn-white btn-default" id="reading-now"><i class="fa fa-envelope"></i> Reading Now</button>
							<button class="btn btn-white btn-default" id="to-read"><i class="fa fa-envelope"></i> I need to read this</button>
                            <button class="btn btn-white btn-default" id="have-read"><i class="fa fa-envelope"></i> I have read this</button>
						</h3>
                    
                    <hr>
                    <div class="description description-tabs">
                        <ul id="myTab" class="nav nav-pills">
                            <li class="active"><a href="#more-information" data-toggle="tab" class="no-margin">Book Description </a></li>
                            <li class=""><a href="#specifications" data-toggle="tab">Specifications</a></li>
                            <li class=""><a href="#reviews" data-toggle="tab">Reviews</a></li>
                        </ul>
                        <div id="myTabContent" class="tab-content">
                            <div class="tab-pane fade active in" id="more-information">
                                <br>
                                <strong>Description Title</strong>
                                <p>{{description}}</p>
                            </div>
                            <div class="tab-pane fade" id="specifications">
                                <br>
                                <dl class="">
                                    <dt>Author</dt>
                                    <dd>{{authors}}</dd>
                                    <br>

                                    <dt>Publisher</dt>
                                    <dd>{{publisher}}</dd>
                                    <br>

                                    <dt>Genre</dt>
                                    <dd>{{categories}}</dd>
                                    <br>

                                    <dt>Published Date</dt>
                                    <dd>{{publishedDate}}</dd>
                                </dl>
                            </div>
                            <div class="tab-pane fade" id="reviews">
                                <br>
                                <form method="post" class="well padding-bottom-10" onsubmit="return false;">
                                    <textarea rows="2" class="form-control" placeholder="Write a review"></textarea>
                                    <div class="margin-top-10">
                                        <button type="submit" class="btn btn-sm btn-primary pull-right">
                                            Submit Review
                                        </button>
                                        <a href="javascript:void(0);" class="btn btn-link profile-link-btn" rel="tooltip" data-placement="bottom" title="" data-original-title="Add Location"><i class="fa fa-location-arrow"></i></a>
                                        <a href="javascript:void(0);" class="btn btn-link profile-link-btn" rel="tooltip" data-placement="bottom" title="" data-original-title="Add Voice"><i class="fa fa-microphone"></i></a>
                                        <a href="javascript:void(0);" class="btn btn-link profile-link-btn" rel="tooltip" data-placement="bottom" title="" data-original-title="Add Photo"><i class="fa fa-camera"></i></a>
                                        <a href="javascript:void(0);" class="btn btn-link profile-link-btn" rel="tooltip" data-placement="bottom" title="" data-original-title="Add File"><i class="fa fa-file"></i></a>
                                    </div>
                                </form>

                                <div class="chat-body no-padding profile-message">
                                    <ul>
                                        <li class="message">
                                            <img src="https://bootdey.com/img/Content/avatar/avatar1.png" class="online">
                                            <span class="message-text"> 
													<a href="javascript:void(0);" class="username">
														Alisha Molly 
														<span class="badge">Purchase Verified</span>
                                            <span class="pull-right">
															<i class="fa fa-star fa-2x text-primary"></i>
															<i class="fa fa-star fa-2x text-primary"></i>
															<i class="fa fa-star fa-2x text-primary"></i>
															<i class="fa fa-star fa-2x text-primary"></i>
															<i class="fa fa-star fa-2x text-muted"></i>
														</span>
                                            </a>
                                            Can't divide were divide fish forth fish to. Was can't form the, living life grass darkness very image let unto fowl isn't in blessed fill life yielding above all moved
                                            </span>
                                            <ul class="list-inline font-xs">
                                                <li>
                                                    <a href="javascript:void(0);" class="text-info"><i class="fa fa-thumbs-up"></i> This was helpful (22)</a>
                                                </li>
                                                <li class="pull-right">
                                                    <small class="text-muted pull-right ultra-light"> Posted 1 year ago </small>
                                                </li>
                                            </ul>
                                        </li>
                                        <li class="message">
                                            <img src="https://bootdey.com/img/Content/avatar/avatar2.png" class="online">
                                            <span class="message-text"> 
													<a href="javascript:void(0);" class="username">
														Aragon Zarko 
														<span class="badge">Purchase Verified</span>
                                            <span class="pull-right">
															<i class="fa fa-star fa-2x text-primary"></i>
															<i class="fa fa-star fa-2x text-primary"></i>
															<i class="fa fa-star fa-2x text-primary"></i>
															<i class="fa fa-star fa-2x text-primary"></i>
															<i class="fa fa-star fa-2x text-primary"></i>
														</span>
                                            </a>
                                            Excellent product, love it!
                                            </span>
                                            <ul class="list-inline font-xs">
                                                <li>
                                                    <a href="javascript:void(0);" class="text-info"><i class="fa fa-thumbs-up"></i> This was helpful (22)</a>
                                                </li>
                                                <li class="pull-right">
                                                    <small class="text-muted pull-right ultra-light"> Posted 1 year ago </small>
                                                </li>
                                            </ul>
                                        </li>
                                    </ul>
                                </div>
                            </div>
                        </div>
                    </div>
                    <hr>
                    <div class="row">
                        <div class="col-sm-12 col-md-6 col-lg-6">
                            <a href="javascript:void(0);" class="btn btn-success btn-lg">Add to cart ($129.54)</a>
                        </div>
                        <div class="col-sm-12 col-md-6 col-lg-6">
                            <div class="btn-group pull-right">
                                <button class="btn btn-white btn-default"><i class="fa fa-star"></i> Add to wishlist </button>
                                <button class="btn btn-white btn-default"><i class="fa fa-envelope"></i> Contact Seller</button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <!-- end product -->
    </div>
</div>
<script type="text/javascript">
	window.onload = function() {
		//Need to code so that averageRating variable is not decimal and dounder to nearest integer
		var averageRating = "{{averageRating}}";
		//console.log(averageRating);
		for (var i = 0; i < averageRating; i++) {
			$('#star-rating').append('<i class="fa fa-star fa-2x text-primary">&nbsp;&nbsp;</i>');
		}
		//console.log(i);
		if (i!=5) {
			for (var j = i; j < 5; j++) {
				$('#star-rating').append('<i class="fa fa-star fa-2x text-muted"></i>');
			}
		}
		$('#star-rating').append('<span class="fa fa-2x"><h5>&nbsp;&nbsp;({{ratingsCount}}) Votes</h5></span>');
		$('#star-rating').append('<a href="javascript:void(0);">&nbsp;&nbsp;109 customer reviews need to chage</a>');

        var in_favourite_books = "{{in_favourite_books}}";
        var in_reading_books = "{{in_reading_books}}";
        var in_to_read_books = "{{in_to_read_books}}";
        var in_have_read_books = "{{in_have_read_books}}";

        if (in_favourite_books=="True") {
            document.getElementById("add-to-favourites").style.background="#24ad52";
        }
        else {
            document.getElementById("add-to-favourites").style.background="#ffffff";
        }

        if (in_reading_books=="True") {
            document.getElementById("reading-now").style.background="#24ad52";
        }
        else {
            document.getElementById("reading-now").style.background="#ffffff";
        }

        if (in_to_read_books=="True") {
            document.getElementById("to-read").style.background="#24ad52";
        }
        else {
            document.getElementById("to-read").style.background="#ffffff";
        }

        if (in_have_read_books=="True") {
            document.getElementById("have-read").style.background="#24ad52";
        }
        else {
            document.getElementById("have-read").style.background="#ffffff";
        }


        console.log(in_favourite_books, in_reading_books, in_to_read_books, in_have_read_books);
	}

    var isbn_13 = "{{isbn_13}}";
    var isbn_10 = "{{isbn_10}}";

    $('#add-to-favourites').click(function() {
        $.ajax({
            type: "PUT",
            data: {
                functionality: 'add-to-favourites',
                isbn_13: "{{isbn_13}}",
                isbn_10: "{{isbn_10}}",
                csrfmiddlewaretoken: $('input[name=csrfmiddlewaretoken]').val()
            },
            success: function(message) {
                if(message=="new_object") {
                    document.getElementById("add-to-favourites").style.background="#24ad52";
                }
                if(message=="remove_object") {
                    document.getElementById("add-to-favourites").style.background="#ffffff";
                }
            }
        })
    });

    $('#reading-now').click(function() {
        console.log("reading-now clicked");

        $.ajax({
            type: "PUT",
            data: {
                functionality: 'reading-now',
                isbn_13: "{{isbn_13}}",
                isbn_10: "{{isbn_10}}",
                csrfmiddlewaretoken: $('input[name=csrfmiddlewaretoken]').val()
            },
            success: function(message) {
                if(message=="new_object") {
                    document.getElementById("reading-now").style.background="#24ad52";
                }
                if(message=="remove_object") {
                    document.getElementById("reading-now").style.background="#ffffff";
                }
            }
        })
    });

    $('#to-read').click(function() {
        console.log("to-read clicked");

        $.ajax({
            type: "PUT",
            data: {
                functionality: 'to-read',
                isbn_13: "{{isbn_13}}",
                isbn_10: "{{isbn_10}}",
                csrfmiddlewaretoken: $('input[name=csrfmiddlewaretoken]').val()
            },
            success: function(message) {
                if(message=="new_object") {
                    document.getElementById("to-read").style.background="#24ad52";
                }
                if(message=="remove_object") {
                    document.getElementById("to-read").style.background="#ffffff";
                }
            }
        })
    });

    $('#have-read').click(function() {
        console.log("have-read clicked");

        $.ajax({
            type: "PUT",
            data: {
                functionality: 'have-read',
                isbn_13: "{{isbn_13}}",
                isbn_10: "{{isbn_10}}",
                csrfmiddlewaretoken: $('input[name=csrfmiddlewaretoken]').val()
            },
            success: function(message) {
                if(message=="new_object") {
                    document.getElementById("have-read").style.background="#24ad52";
                }
                if(message=="remove_object") {
                    document.getElementById("have-read").style.background="#ffffff";
                }
            }
        })
    });
</script>
{% endblock %}